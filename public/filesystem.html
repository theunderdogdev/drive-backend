{% extends 'base.html' %} {% block content %}
<div id="addressbar">
	Address
	<input type="text" class="form-control" id="address" placeholder="Enter address to file/folder" value="{{path['pwd']}}" />
</div>
<button class="btn btn-primary ctrl-btn" id="bck-btn">
	<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
		<path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z" />
	</svg>
</button>
<div class="interface">
	{% if path['dirs'] %} {% for dir in path['dirs'] %}
	<a href="{{dir}}" class="btn btn-outline-primary fs-link">{{dir[1:]}}</a>
	{% endfor %} {% endif %}
</div>
<style>
	#bck-btn {
		z-index: 2;
		position: fixed;
		top: 10px;
		left: 10px;
	}
	#addressbar {
		width: 100%;
		height: 100px;
		position: fixed;
		top: 30px;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 10px;
		padding: 0px 20px;
	}
	.interface {
		margin-top: 150px;
		width: 100%;
		height: fit-content;
		padding: 10px;
	}
</style>
<script>
	$(document).ready(function () {
		const addressBar = $("#address");
		const bckBtn = $("#bck-btn");
		const getFolderContents = () => {
			$.ajax({
				url: "/foldercontents",
				type: "POST",
				contentType: "application/json",
				data: JSON.stringify({
					path: addressBar.val(),
				}),
				success: function (resp) {
					console.log(resp);
				},
			});
		};
		const checkControl = () => {
			if (addressBar.val() == "/User" || addressBar.val() == "") {
				bckBtn.prop("disabled", true);
			} else {
				bckBtn.prop("disabled", false);
			}
		};
		const editPath = (newPath) => {
			addressBar.val(addressBar.val() + newPath);
			addressBar.trigger("input");
		};
		checkControl();
		$(".fs-link").click(function (e) {
			e.preventDefault();
			editPath($(this).attr("href"));
		});
		bckBtn.click(function () {
			const val = addressBar.val().slice(1).replace(/\/+$/, "").split("/");
			const a = [];
			if (val.length == 1 && val[0] == "User") {
				bckBtn.prop("disabled", true);
			} else {
				val.pop();
				addressBar.val("/" + val.join("/"));
				addressBar.trigger("input");
			}
		});
		addressBar.on("input", function () {
			checkControl();
			if ($(this).val() != "") {
				// console.log(addressBar.val());
				getFolderContents();
			}
		});
	});
</script>
{% endblock content %}
