<!DOCTYPE html>
<html lang="en">
	<head>
		<%- include ("./base.ejs"); %>
	</head>
	<body>
		<div id="addressbar">
			Address
			<input type="text" class="form-control" id="address" placeholder="Enter address to file/folder" value="<%-path.pwd %>" />
		</div>
		<button class="btn btn-outline-primary rounded-circle" id="create-folder">+</button>
		<a href="/folders/6295a9963526db756e309672" class="btn btn-outline-primary">/Users</a>
		<style>
			#bck-btn {
				z-index: 2;
				position: fixed;
				top: 10px;
				left: 10px;
			}
			#addressbar {
				width: 100%;
				height: 100px;
				position: fixed;
				top: 30px;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 10px;
				padding: 0px 20px;
			}
			.interface {
				margin-top: 150px;
				width: 100%;
				height: fit-content;
				padding: 10px;
			}
		</style>
		<script>
			$(document).ready(function () {
				const adrBar = $("#address");
				$("#create-folder").click(function () {
					let path = adrBar
						.val()
						.slice(1)
						.replace(/\/{2,}/g, "/")
						.replace(/\/+$/, "");

					adrBar.val("/" + path);
					const folderArray = path.split("/");
					let currFolderName;
					let parentFolder;
					if (folderArray.length > 1) {
						currFolderName = "/" + folderArray[folderArray.length - 1];
						parentFolder = "/" + folderArray[folderArray.length - 2];
					} else {
						currFolderName = "/User";
						parentFolder = "/";
					}
					console.log(`curr:${currFolderName}, parent:${parentFolder}`);
					$.ajax({
						url: "/createfolder",
						type: "POST",
						contentType: "application/json",
						data: JSON.stringify({
							parent: parentFolder,
							pwd: currFolderName,
						}),
						success: function (resp) {
							console.log(resp);
						},
					});
				});
			});
		</script>
	</body>
</html>
